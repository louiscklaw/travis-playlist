
jobs:
  include:
    - stage: Test
      name: test travis-build-merger
      script:
        - cd travis-build-merger

        # - ./test/run_test.sh
        - sudo apt update
        - sudo apt install -y python3 python3-pip python3-dev python3-wheel python3-setuptools
        - python3 -m pip install pipenv

        - pipenv sync
        - pipenv run python3 ./test/test.py

        - cd ..

    - stage: Merge
      script:
        # the below should be kept for test inside travis-playlist only
        - wget https://raw.githubusercontent.com/louiscklaw/travis-playlist/master/travis-build-merger/merge_if_success_test.sh
        - bash merge_if_success_test.sh

        # production code
        # - wget https://raw.githubusercontent.com/louiscklaw/travis-playlist/master/travis-build-merger/merge_if_success.sh
        # - bash merge_if_success.sh
